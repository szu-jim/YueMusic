$(function(){function a(a){$.ajax({type:"post",url:"getMusicDetailByID",data:"id="+a,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",async:!1,success:function(a){$.each(a.detailInfo,function(a,e){r.mp3=e.song_path,r.song=e.song,r.singer=e.singer,r.number=e.number,r.id=e.id,r.amount=e.amount,r.playTime=e.play_time,r.musicGroup=e.music_group}),i=r.id,o=r.number}})}function e(a){l=r.musicGroup,$.ajax({type:"post",url:"getMusicDetailByNumber",data:"number="+a+"&musicGroup="+l.toString(),dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",async:!1,success:function(a){$.each(a.detailInfo,function(a,e){r.mp3=e.song_path,r.song=e.song,r.singer=e.singer,r.playTime=e.play_time,r.id=e.id}),i=r.id}})}function s(a){$("#"+a.id).parents(".right").find("li").css("background-color","RGB(247,247,247"),$("#"+a.id).parents("#right").find("li").css("background-color","RGB(247,247,247"),$("#"+a.id).css("background-color","RGB(230,230,230")}function t(a){p.src=a.mp3,p.play(),$("#play").removeClass("playback").addClass("pause"),$(".progress .middle .p_top").html('<div class="p_singername">'+a.singer+'</div><div class="p_songname">'+a.song+"</div>"),$(".progress .right").html(a.playTime),c=setInterval(m,1e3)}function n(){0==u?o<r.amount?o++:o=1:1==u&&(o=Math.floor(Math.random()*r.amount+1)),e(o),s(r),t(r)}var i,o,l,c,r={},p=$("audio")[0],u=localStorage.playType||0;0==u?$(".type1").css("opacity","1"):1==u&&$(".type2").css("opacity","1"),p.loop=!1,function(a,e,s){a.addEventListener?a.addEventListener(e,s,!1):a.attachEvent?a.attachEvent("on"+e,s):a["on"+e]=s}(p,"ended",function(){n()}),$(".rank li").click(function(){a($(this).attr("id")),s(r),t(r)}),$("#play").click(function(){$(this).hasClass("playback")?(p.play(),$(this).removeClass("playback").addClass("pause"),$(".progress .middle .p_top").html('<div class="p_singername">'+r.singer+'</div><div class="p_songname">'+r.song+"</div>"),$(".progress .right").html(r.playTime),c=setInterval(m,1e3)):$(this).hasClass("pause")&&(p.pause(),$(this).removeClass("pause").addClass("playback"),clearInterval(m))}),$(".type1").click(function(){u=localStorage.playType=0,$(".type1").css("opacity","1"),$(".type2").css("opacity","0.3")}),$(".type2").click(function(){u=localStorage.playType=1,$(".type2").css("opacity","1"),$(".type1").css("opacity","0.3")}),$(".fastforward").click(function(){n()}),$(".rewind").click(function(){0==u?o>1?o--:o=r.amount:1==u&&(o=Math.floor(Math.random()*r.amount+1)),e(o),s(r),t(r)});var d=function(a){var e=parseInt(a%60)<10?"0"+parseInt(a%60):parseInt(a%60),s=parseInt(a/60)<10?"0"+parseInt(a/60):parseInt(a/60);ratio=a/p.duration*100,$(".timer").html(s+":"+e),$(".progress .pace").css("width",ratio+"%"),$(".progress .slider a").css("left",ratio+"%")},m=function(){d(p.currentTime)};$(".progress .slider").slider({min:0,max:100,step:.1,slide:function(a,e){$(this).addClass("enable"),d(p.duration*e.value/100),clearInterval(c)},stop:function(a,e){p.currentTime=p.duration*e.value/100,$(this).removeClass("enable"),c=setInterval(m,500)}});var y=function(a){audio.volume=localStorage.volume=a,$(".volume .pace").css("width",100*a+"%"),$(".volume .slider a").css("left",100*a+"%")},v=localStorage.volume||.5;audio.volume=localStorage.volume||.5,$(".volume .slider").slider({max:1,min:0,step:.01,value:v,slide:function(a,e){y(e.value),$(this).addClass("enable"),$(".mute").removeClass("enable")},stop:function(){$(this).removeClass("enable")}}).children(".pace").css("width",100*v+"%"),$(".mute").click(function(){$(this).hasClass("enable")?(y($(this).data("volume")),$(this).removeClass("enable")):($(this).data("volume",audio.volume).addClass("enable"),y(0))})});